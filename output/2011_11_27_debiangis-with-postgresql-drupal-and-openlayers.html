<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags always come first -->
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>From scratch and testing ideas: DebianGIS with Postgresql, Drupal and OpenLayers | Another Life Form
</title>
  <link rel="canonical" href="http://mfactor.sdf.org/2011_11_27_debiangis-with-postgresql-drupal-and-openlayers.html">

  <link rel="alternate" type="application/atom+xml" href="http://mfactor.sdf.org/feeds/all.atom.xml" title="Full Atom Feed">
  <link rel="alternate" type="application/atom+xml" href="http://mfactor.sdf.org/feeds/gis.atom.xml" title="Categories Atom Feed">


  <link rel="stylesheet" href="http://mfactor.sdf.org/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="http://mfactor.sdf.org/theme/css/font-awesome.min.css">
  <link rel="stylesheet" href="http://mfactor.sdf.org/theme/css/pygments/monokai.min.css">
  <link rel="stylesheet" href="http://mfactor.sdf.org/theme/css/style.css">


<meta name="description" content="Here we go again to try to build a server for GIS using Debian. Downloaded the image from http://cdimage.debian.org/debian-cd/6.0.3/amd64/iso-cd/debian-6.0.3-amd64-netinst.iso For the basic install (I’ll be doing the install in a VM). Language: Portuguese Brazilian. All other …">
</head>

<body>
  <header class="header">
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <h1 class="title"><a href="http://mfactor.sdf.org">Another Life Form</a></h1>
          <ul class="list-inline">
            <li class="list-inline-item"><a href="https://br.linkedin.com/in/ispmarin/en" target="_blank">linkedin</a></li>
            <li class="list-inline-item"><a href="https://github.com/ispmarin" target="_blank">github</a></li>
            <li class="list-inline-item text-muted">|</li>
            <li class="list-inline-item"><a href="http://mfactor.sdf.org/pages/about.html">About</a></li>
          </ul>
        </div>
      </div>
    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>From scratch and testing ideas: DebianGIS with Postgresql, Drupal and&nbsp;OpenLayers
</h1>
      <hr>
<article class="article">
  <header>
    <ul class="list-inline">
      <li class="list-inline-item text-muted" title="2011-11-27T12:49:00-02:00">
        <i class="fa fa-clock-o"></i>
        Dom 27 Novembro 2011
      </li>
      <li class="list-inline-item">
        <i class="fa fa-folder-open-o"></i>
        <a href="http://mfactor.sdf.org/category/gis.html">gis</a>
      </li>
      <li class="list-inline-item">
        <i class="fa fa-user-o"></i>
        <a href="http://mfactor.sdf.org/author/ivan-marin.html">Ivan Marin</a>      </li>
      <li class="list-inline-item">
        <i class="fa fa-files-o"></i>
        <a href="http://mfactor.sdf.org/tag/debian.html">#debian</a>,         <a href="http://mfactor.sdf.org/tag/debiangis.html">#debiangis</a>,         <a href="http://mfactor.sdf.org/tag/gis.html">#gis</a>      </li>
    </ul>
  </header>
  <div class="content">
    <p>Here we go again to try to build a server for <span class="caps">GIS</span> using&nbsp;Debian.</p>
<p>Downloaded the image&nbsp;from</p>
<p><a class="reference external" href="http://cdimage.debian.org/debian-cd/6.0.3/amd64/iso-cd/debian-6.0.3-amd64-netinst.iso">http://cdimage.debian.org/debian-cd/6.0.3/amd64/iso-cd/debian-6.0.3-amd64-netinst.iso</a></p>
<p>For the basic install (I&#8217;ll be doing the install in a <span class="caps">VM</span>). Language:
Portuguese Brazilian. All other options were kept as the defaults,
choosing single filesystem and all mount points on the same partition.
Other change: ext4 instead of ext3, and removed the option of the
Desktop. The installation was over under 15&nbsp;min.</p>
<p>Now, configuring the backport repositories: From
<a class="reference external" href="http://backports-master.debian.org/Instructions/">here</a>[debian
backports], add this line to the&nbsp;/etc/apt/sources.list:</p>
<pre class="literal-block">
deb http://backports.debian.org/debian-backports squeeze-backports main
</pre>
<p>Do an apt-get update, and install the necessary packages. First, from
main&nbsp;reps:</p>
<pre class="literal-block">
apt-get --no-install-recommends install vim make build-essential gcc g++ gfortran ssh
</pre>
<p>Done. Time to start installing the web&nbsp;packages:</p>
<pre class="literal-block">
apt-get --no-install-recommends -t squeeze-backports install apache2 postgresql-9.1 postgis php5-pgsql php5 php5-cgi php5-gd vsftpd
</pre>
<p>That&#8217;s why I _love_ Debian. Let&#8217;s proceed: now it&#8217;s time to configure
the basic database for the next step, installing drupal. Following this
<a class="reference external" href="http://drupal.org/node/284991">drupal&nbsp;documentation,&nbsp;</a></p>
<pre class="literal-block">
su - postgres
createuser --pwprompt --encrypted --no-adduser --no-createdb drupal
createdb --encoding=UNICODE --owner=drupal drupaldb
</pre>
<p>Done! User and database for drupal created. Now it&#8217;s time to dowload
drupal itself. I chose to download drupal 7 from the website than from
the debian repositories because of some debian particularities, like
versioning. I downloaded the latest version from
<a class="reference external" href="http://drupal.org/project/drupal">here</a>[drupal.org]:</p>
<pre class="literal-block">
wget http://ftp.drupal.org/files/projects/drupal-7.9.tar.gz
</pre>
<p>And downloaded to /var/www. As I&#8217;m planning this server to be run
exclusively as a <span class="caps">GIS</span> server, I extracted all drupal files to /var/www,
and _not_ inside the directory drupal-7.9. After redirecting the ports
from Virtualbox, we&#8217;re ready to start the drupal installation. First,
changing the permission for the files to 775, user and group to
www-data, and following <a class="reference external" href="http://drupal.org/documentation/install/developers">drupal installation
instructions</a>[drupal.org]:</p>
<pre class="literal-block">
cp sites/default/default.settings.php sites/default/settings.php
</pre>
<p>Just remember that if there is an error with php, you have to restart
apache and close your browser: google chrome kept insisting in
downloading install.php instead of running it, even if phpinfo() was
running ok. So let&#8217;s continue: Standard installation, English, and use
the database name (drupaldb) and user (drupal) with the password that
was configured before, and drupal should install. The ftp server that
drupal uses for update (we installed the vsftpd) should be also
configured: in the file /etc/vsftpd.conf, the local users option must be&nbsp;enabled:</p>
<pre class="literal-block">
Uncomment this to allow local users to log in.
local_enable = YES
</pre>
<p>Drupal should be running! Time to install new modules, the ones that
<a class="reference external" href="http://drupal.org/node/627816">OpenLayers</a>&nbsp;[drupal.org]&nbsp;requests:</p>
<p><a class="reference external" href="http://drupal.org/project/views">Views:</a>&nbsp;<a class="reference external" href="http://ftp.drupal.org/files/projects/views-7.x-3.0-rc3.tar.gz">http://ftp.drupal.org/files/projects/views-7.x-3.0-rc3.tar.gz</a></p>
<p><a class="reference external" href="http://drupal.org/project/openlayers">OpenLayers</a>:&nbsp;<a class="reference external" href="http://ftp.drupal.org/files/projects/openlayers-7.x-2.0-beta1.tar.gz">http://ftp.drupal.org/files/projects/openlayers-7.x-2.0-beta1.tar.gz</a></p>
<p><a class="reference external" href="http://drupal.org/project/ctools">Chaos
Tools:</a>&nbsp;<a class="reference external" href="http://ftp.drupal.org/files/projects/ctools-7.x-1.0-rc1.tar.gz">http://ftp.drupal.org/files/projects/ctools-7.x-1.0-rc1.tar.gz</a></p>
<p>And went to the Modules administration in drupal to enable the new
modules. That&#8217;s it! The webserver is working with all the necessary&nbsp;modules!</p>
<p>There is another tool that seems to be very useful in this context:
<a class="reference external" href="http://drupal.org/project/drush">drush</a>. To make it work, php-pear
must be installed.&nbsp;Now,</p>
<pre class="literal-block">
pear channel-discovery pear.drush.org
pear install drush/drush
</pre>
<p>After that, another module will be integrated:
<a class="reference external" href="http://drupal.org/project/geofield">geofield</a>, for the geographical
data manipulation. Drush didn&#8217;t help, so I had to install by hand drupal&nbsp;libraries</p>
<pre class="literal-block">
http://ftp.drupal.org/files/projects/libraries-7.x-1.0.tar.gz
</pre>
<p>And after enabling it, installed the geofield&nbsp;module:</p>
<p><a class="reference external" href="http://drupal.org/project/geofield">Geofield:</a>&nbsp;<a class="reference external" href="http://ftp.drupal.org/files/projects/geofield-7.x-1.0-beta2.tar.gz">http://ftp.drupal.org/files/projects/geofield-7.x-1.0-beta2.tar.gz</a></p>
<p>Enabled it, and it&#8217;s working! Server up and fully loaded. Now it&#8217;s time
to start writing&nbsp;code&#8230;</p>
<p>* <span class="caps">NOTE</span> * I didn&#8217;t take <span class="caps">ANY</span> security measures to secure the server.
There are several things that should be changed to secure apache,
drupal, ssh,&nbsp;ftp&#8230;</p>

  </div>
</article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="row">
       <ul class="col-sm-6 list-inline">
          <li class="list-inline-item"><a href="http://mfactor.sdf.org/authors.html">Authors</a></li>
          <li class="list-inline-item"><a href="http://mfactor.sdf.org/archives.html">Archives</a></li>
          <li class="list-inline-item"><a href="http://mfactor.sdf.org/categories.html">Categories</a></li>
          <li class="list-inline-item"><a href="http://mfactor.sdf.org/tags.html">Tags</a></li>
        </ul>
        <p class="col-sm-6 text-sm-right text-muted">
          Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a> / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
        </p>
      </div>
    </div>
  </footer>
</body>

</html>